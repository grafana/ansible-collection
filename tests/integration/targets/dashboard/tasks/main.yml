- name: Create/Update a dashboard
  grafana.grafana.dashboard:
    dashboard: {
      "id": null,
      "uid": "cLV5GDCkz",
      "title": "New dashboard",
      "tags": [],
      "style": "dark",
      "timezone": "browser",
      "editable": true,
      "graphTooltip": 1,
      "panels": [],
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "time_options": [],
        "refresh_intervals": []
      },
      "templating": {
        "list": []
      },
      "annotations": {
        "list": []
      },
      "refresh": "5s",
      "schemaVersion": 17,
      "version": 0,
      "links": []
    }
    stack_slug: "{{ stack_name }}"
    grafana_api_key: "{{ grafana_api_key }}"
    state: present
  register: result

- debug:
    var: result

- assert:
    that:
      - "result.changed == true"
      - "result.msg == 'Dashboard test created'"